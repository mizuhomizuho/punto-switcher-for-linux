
# Punto Switcher For Linux

## Что умеет скрипт?

1) Конвертировать последнее слово перед курсором.
2) Конвертировать последнее слово в терминале Gnome.
3) Конвертировать выделенное.

Направление конвертации (En->Ru или Ru->En) зависит от того,
какая раскладка активна на момент нажатия горячих клавиш.

Скрипт можно настроить не только с Ru, но и с любым другим языком.

## Важно понимать: 

Скрипт скорее всего сразу не будет корректно работать даже если у Вас,
как и у меня - Linux Mint 22.1 Cinnamon...

Корректность работы зависит от конкретного железа, драйверов, ПО и т.д.

По этому, сразу наберитесь сил и терпения, т.к. придется лезть в код, если с ходу не заработает.

Далее я попробую описать так, чтоб Вам было как можно легче все настроить...

## Установка утилит:

```bash
sudo apt install -y xautomation # xte
sudo apt install -y xsel xdotool xbindkeys
```

## Настройка горячих клавиш:

Сочетания клавиш, для работы скриптов, нужно указывать именно через xbindkeys.
Т.к. в xbindkeys можно указать тип события "Release", т.е. когда все клавиши были отпущены.
Иначе, работать точно не будет.

1) Добавляем в конец ~/.xbindkeysrc (если нету, то нужно создать):
   ```text
   "~/my_soft_path/punto_switcher/switch_last.sh"
   Release + Pause
   
   "~/my_soft_path/punto_switcher/switch_select.sh"
   Release + Control + Alt + z
   ```
2) Меняем "~/my_soft_path" на свой путь до папки "punto_switcher".

3) Можно выбрать свои свободные комбинации клавиш:
   - У меня это "Pause" - для конвертации последнего слова перед курсором.
   - И "Control + Alt + z" - для выделенного текста.

4) Перезапускаем xbindkeys:
   ```bash
   xbindkeys
   ```

## Если с ходу нет нужного результата (не работает):

По сути скрипт делает то, что Вы сами сделали бы нажатиями клавиш, т.е. делает автоматизацию...

Корректность работы зависит от конкретного железа, драйверов, ПО и т.д.

Нужно будет заняться отладкой. Скрипты можно запускать в консоли и (или) делать вывод результатов в файл.

1) Стоит обратить внимание на значения "sleep" в коде, стоит увеличивать время пауз или добавлять новые sleep.
2) Возможно где-то надо будет поменять порядок эмуляции нажатия клавиш. И возможно, названия клавиш.
3) Соответствия можно переопределить в enToRu и ruToEn.
4) Направление конвертации (enToRu или ruToEn) зависит от того, какая раскладка активна на момент нажатия горячих клавиш.

### Тут находим ID своей клавиатуры:

   В моем случае это оказалось 14... Как определить свой ID смори далее.

   ```bash
   xinput list
   ```
   <img style="max-width: 300px" src="https://github.com/mizuhomizuho/punto-switcher-for-linux/blob/master/screenshots/s1.png" alt="">

### Тут будет видно нажатия клавиш, их числовой код:

   ```bash
   xinput test 14
   ```
   
   Если ID верный, мы будем видеть подобное, нажимая на клавиши:

   <img style="max-width: 300px" src="https://github.com/mizuhomizuho/punto-switcher-for-linux/blob/master/screenshots/s2.png" alt="">

### Тут будет видно все клавиши, их коды и названия:

   ```bash
   xmodmap -pke
   ```

   <img style="max-width: 300px" src="https://github.com/mizuhomizuho/punto-switcher-for-linux/blob/master/screenshots/s3.png" alt="">

### Для настройки конвертации последнего слова в терминале (Gnome terminal):

   #### Смотрим что выводит:

   ```bash
   xprop -id "$(xdotool getactivewindow)" WM_CLASS | awk -F '"' '{print $4}'
   ```

   Если команда, выполненная в активном окне Gnome terminal, выводит не "Gnome-terminal",
   то найдите в src/functions.sh "Gnome-terminal" и исправьте на нужное значение.

### Вся логика тут:

<img style="max-width: 300px" src="https://github.com/mizuhomizuho/punto-switcher-for-linux/blob/master/screenshots/s4.png" alt="">

Поставь звезду, если норм =)